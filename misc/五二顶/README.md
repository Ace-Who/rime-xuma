# 徐码五二顶说明书

## 什么是五二顶

四码限长方案的用户应该都熟悉「五码顶屏」的打法，即每次打第五码时就顶出前四码，
上屏其第一候选，此时输入缓冲区只剩下最后一码，从而实现省略四码字后面的空格的目
的。然而五笔、郑码这样的方案，对于单字派，四码字的频率是很低的，节省的空格对整
体效率的贡献很小，粗略测算为 3%。而徐码的四码字频率还要低一些，因此贡献更小。那
么几码字的频率最高呢？对于徐码，答案是二码字。徐码的二码字频率几乎占到一半，所
以，从效率的角度讲，最佳选择是节省二码字的空格。我们需要一个方案来实现这个目的
，「五二顶」为此而生。它与常规方案的区别仅仅是每逢五码顶出的是前二码，剩下的是
后三码。五二顶与常规方案的码表一致，保持了徐码「完美的规则性」。

始终要记得，五二顶的效率源自二码字的高比例。如果是词组派，要打全码词组，那么第
一候选词组打得越多，四键词就比例就越高（非第一候选的键长>=5，在五二顶中没有变）
，二码字比例就越低，就越削弱五二顶的效率优势。因此五二顶不适合极端的全码词组派。

## 优势：效率与大字集兼顾

省略了多少空格？键长降低了多少？

用科学形码评测系统v1.6.3 测试，前 `300/1500/6000` 字的加权键长依次为
`2.14/2.53/2.61`。（需要把「的」字改为一键顶屏字，否则结果是 `2.20/2.57/2.65`。
实际使用不是通过码表定义，而是在方案中通过配置标点实现，由于标准键盘已无空余的
理想键位可用，本方案暂不便提供通用配置。）

| 编码方案 | 前 300 加权 | 前 1500 加权 | 前 6000 加权 |
| ---------- | ------ | ------ | ------ |
| 可可五笔86 | `2.95` | `3.19` | `3.23` |
| 郑码       | `2.90` | `3.16` | `3.20` |
| 张码       | `2.91` | `3.14` | `3.18` |
| 徐码       | `2.91` | `3.15` | `3.19` |
| 徐码QS     | `2.81` | `3.07` | `3.12` |
| 徐码五二¹ | `2.20` | `2.57` | `2.65` |
| 徐码五二² | `2.14` | `2.53` | `2.61` |

可以看到，诸四码限长方案的差距仅在 `2%` 以内。相比于我的个人徐码码表，五二顶的加
权键长（按不配置一键顶屏字「的」计）缩短了 `22%/16%/15%`，即后者键长为前者的
`78%/84%/85%` ，在同样击键速度的条件下，打字速度比值是其倒数，即
`128%/119%/118%`。若与官方码表相比，则这组数字是 `132%/123%/120%`。不过考虑到指
法，空格键优于全体按键的平均水平，节省大量空格之后剩余按键的指法平均水平略低于
原有水平。因此实际击键速度会低于常规方案，从而打字速度会可能略低于理论值。

经赛码器测试，用五二顶和常规方案打文章，都打单字时键长降低 15%~18%，都打简词时
键长降低 12%~15%，符合前述评测系统的结果。我个人不打任何全码词组，五二顶的最佳
实践也是不打全码词组，所以大词库的测试就不做了。

简言之，键长令人满意。五二顶改造当然无法和原生的顶功方案相提并论，但是别忘了徐
码是以全体九万汉字为编码目标的，无论是加权还是未加权的重码率都是最低之一，本方
案没有牺牲这一优势。

## 一二级简码的区重补码

输入三码（或四码）后，若要选重，存在一个歧义，是要对整段输入码选重，还是要对后
一码（或后两码）选重？本方案用数字键作为整体选重键，另引入区重补码来对后一段输
入码选重。

一级简码和二级简码设置了三重候选，一为单字，二三为词组。方案为它们增设区重补码
`[ ; '`，打出补码后自动上屏。如 `u` 的三重候选为 「的／的是／的时候」，它们同时
还有另一组编码，即 `u[  u;  u'`，输入这组编码即可自动上屏这三个词条。为指法计，
补码 `[` 还绑定到了 `TAB` 键，这样安排在双手对称位置，可避免同手连击和小指大移
位的同时发生。

技术上，区重补码不是选重键，而是编码的一部分。所以即使在码表中更改了词条的顺序
，它们的区重补码也不会改变。

在三码或四码后输入补码时，会上屏前二码的第一候选和余下编码对应的简码词条。参
考下面的示例。

## 打字示例详解

例子（`_` 表示空格）：

    fstgl_ = 示例 = fs_tgl_

在输入 `l` 时输入码长度达到 5，会顶出前二码 `fs` 并上屏其第一候选「示」，余下三
码 `tgl` 的唯一候选是「例」，按空格后上屏。

    mhqd_ = 艶
    mhqd2 = 黑色
    mhqd[ = 黑色（等同于 mh_qd_）

空格上屏等同于按数字键 1，是上屏候选列表的第一项。同样是上屏「黑色」，`mhqd2`
是选择 `mhqd` 的第二候选，是词组打法。`mhqd[` 是依次上屏「黑」「色」二字，是单
字打法。`mh = 黑, qd[ = 色`，在输入 `[` 时顶出前二码 `mh`，自动上屏「黑」和「色
」。五二顶是可以完全打单字或简词的，具有完全的确定性，因为它和常规的五码顶屏没
有本质区别。又如：

    xk[ = xk_ = 单
    wb[ = wb_ = 字
    xkwb[ = 单字 = xk_wb_（打单字）
    xkwb_ = 单字（打词组）

    sb[ = sb_ = 很
    ea; = ea2 = 可能
    sbea; = 很可能 = sb_ea2
    sbea_ = 律动

    cbu[ = 好的 = cb_u_
    qowb_ = 名字 = qo_wb_
    yuwci_ = 方案 = yu_wci_
    zxksbb[ = 说明书 = zx_ks_bb_

注意，顶的是前二码，不是二码字不能顶上屏，只能用空格或数字键上屏。正如五四顶中
只能顶前四码，不是四码字词就必须用空格或选重键上屏。错误顶码的例子：

    正：f_cx_ = 大小
    误：fcx[ = 车道 = fc_x_

    正：pvz_rk_ = 选重
    误：pvzrk[ = 先话是 = pv_zr_k_

    正：sui_gam_ = 徐码
    误：suigam[ = 脸工马 = su_ig_am_（三码字并无区重补码，gam[ 也不对）

又注意，顶的是首选，非首选只能先上屏，再输入后续文字的编码。错误顶码的例子：

    kj 的首选不是「思考」而是「甲」，所以「思考」不能通过顶码来上屏
    正：kj;kg_ = 思考题
    误：kjkg[ = 甲题 = kj_kg_

## 键长比较和演示

下面依次用常规方案的单字打法、简词打法和五二顶方案的单字打法、简词打法来打同一
段文字。常规方案打法也省略标点前的空格。候选列表的选重键假定为数字键（常规方案
固然可以定义符号键选重，但由于顶功占用了符号来作区重补码，就统一为数字键选重，
以免混淆和误解。）试比较它们的键长。

```
原始文本（下方标注简词）：
冰灯是流行于中国北方的一种古老的民间艺术形式。因为独特的地域优势，黑龙江可以说是制作冰灯最早的地方。
　　　　　　﹀﹀　　　　　　　　　　﹀﹀︾︾　﹀﹀　　　　　　　　　　　﹀﹀　　﹀﹀　　　　　﹀﹀　
xa_xed_k_zy_sx_gi_o_ne_xvi_yu_u_g_ro_jg_jv_u_df_zk_hb_iwu_ghs_fi.nf_zc_vlv_pji_u_j_jfo_tjo_fr,mh_jpu_zi_eo_c_zx_k_pm_tp_xa_xed_kh_kz_u_j_yu.
xa_xed_k_zy_xs_gi_o;xvi_yu_u_g_ro_jg_jv_u_df_zk_hb3gh3.n2vl3u_j_jfo_tjo_fr,mh_jpu_zi_e2zx_k_pt2xa_xed_kh_kz_u_j3.
xaxed_k_zysxgio[nexvi_yuu[g_rojgjvu[dfzkhbiwu_ghs_fi.nfzcvlv_pji_u_j_jfo_tjo_fr,mhjpu_zieoc[zxk[pmtpxaxed_khkzu[j_yu.
xaxed_k_zysxgio;xvi_yuu[g_rojgjvu[dfzkhb'gh'.n;vl'u_j_jfo_tjo_fr,mhjpu_zie;zxk[pt;xaxed_khkzu[j'.
```

以下是单字打法和简词打法的慢速动态演示，包含「预显候选」开启和关闭两种情况：

![单字慢速](demo/slow_single_style.gif)
![单字慢速](demo/slow_single_style_with_precand.gif)

![简词慢速](demo/slow_phrase_style.gif)
![简词慢速](demo/slow_phrase_style_with_detailed_precand.gif)

以下是单字打法和简词打法的正常速度动态演示：

![单字常速](demo/single_style_with_precand.gif)
![简词常速](demo/phrase_style_with_precand.gif)

一二简的第一候选总是可以用 `[` 上屏的，而空格上屏只能用在单独打的时候（即不是紧
接在二码字后）。如果每次先判断前一个字是不是单独打的、是不是一码或二码字，可能
降低效率，不容易形成条件反射，所以可以考虑在初期一律用 `[` 上屏一二码的第一候选
，即如下打法：

```
冰灯是流行于中国北方的一种古老的民间艺术形式。因为独特的地域优势，黑龙江可以说是制作冰灯最早的地方。
xaxed_k[zysxgio[nexvi_yuu[g[rojgjvu[dfzkhbiwu_ghs_fi.nfzcvlv_pji_u[j[jfo_tjo_fr,mhjpu_zieoc[zxk[pmtpxaxed_khkzu[j[yu.
xaxed_k[zysxgio;xvi_yuu[g[rojgjvu[dfzkhb'gh'.n;vl'u[j[jfo_tjo_fr,mhjpu_zie;zxk[pt;xaxed_khkzu[j'.
```

## 与常规版功能的差异

### 造词和连打

切分符只能是反撇号 `` ` ``，并且插入切分符后才能进入「连打·造词」模式，造词是
在此模式中，自造词也只能在该模式中看到，这是由于 Rime 实现方式的限制。如造「五
二顶」，需输入 ``gd`ee`egm`` 并上屏，该词组即编码为 `geeg`，要调出时，需输入 ``
geeg` ``。

## 五二顶的最佳实践

五二顶的最佳实践是只打单字或打单字和简词，原则上避免打全码词组，这样思维负担较
小，且码长已经能与大多数四码限长方案与大词库的组合相匹敌。另外简码词库小且固定
（仅 1400 左右，其中少数低频词可不打），省去大量维护精力。

## 鸣谢

用 Rime 改造徐码为五二顶的方法来自蓝落萧的形音四二顶方案
[C42](https://github.com/lanluoxiao/c42)。
